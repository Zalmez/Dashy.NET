@page "/styleguide"
@using System.Text.Json
@using Dashy.Net.Shared.Models
@using Dashy.Net.Web.Components.Shared.Widgets
@using Dashy.Net.Web.Services
@inject ThemeService ThemeService

<PageTitle>Styleguide</PageTitle>

<div class="content">
    <h1>Styleguide</h1>
    <p>This page showcases common UI elements and a few widgets in the current theme.</p>

    <section>
        <h2>Buttons</h2>
        <div class="mb-3" style="display:flex; gap:.5rem; flex-wrap:wrap;">
            <button class="btn btn-primary">Primary</button>
            <button class="btn btn-secondary">Secondary</button>
            <button class="btn" style="border:1px solid var(--border-color)">Default</button>
        </div>
    </section>

    <section>
        <h2>Inputs</h2>
        <EditForm Model="this">
            <div class="form-group" style="max-width:420px;">
                <label for="sg-input">Label</label>
                <InputText id="sg-input" class="form-control" @bind-Value="_sampleText" />
            </div>
        </EditForm>
    </section>

    <section>
        <h2>Alerts</h2>
        <div class="alert alert-success">Success alert example</div>
        <div class="alert alert-danger">Danger alert example</div>
        <div class="alert alert-warning">Warning alert example</div>
        <div class="alert alert-info">Info alert example</div>
    </section>

    <section>
        <h2>Widgets Preview</h2>
        <p style="color:var(--subtle-text-color)">These use in-memory data to preview look and feel.</p>
        <div class="items-wrapper layout-auto" style="display:grid; grid-template-columns:repeat(auto-fit, minmax(260px,1fr)); gap:1rem;">
            <div class="item">
                <StaticLinkWidget Item="_linkItem" OnItemDeleted="_ => {}" OnItemEdited="() => Task.CompletedTask" />
            </div>
            <div class="item">
                <ClockWidget Item="_clockItem" OnItemDeleted="_ => {}" OnItemEdited="() => Task.CompletedTask" />
            </div>
            <div class="item">
                <RssWidget Item="_rssItem" OnItemDeleted="_ => {}" OnItemEdited="() => Task.CompletedTask" />
            </div>
        </div>
    </section>
</div>

@code {
    private string _sampleText = "";

    // Build JsonElements for widget options
    private static JsonElement MakeOptions(object obj) => JsonSerializer.SerializeToElement(obj);

    private ItemVm _linkItem = new(
        Id: 1001,
        Title: "Dashy.NET Repo",
        Icon: "fab fa-github",
        Widget: "static-link",
        SectionId: 1,
        Options: MakeOptions(new { url = "https://github.com/Zalmez/Dashy.NET", target = "_blank", Description = "Visit the repository" })
    );

    private ItemVm _clockItem = new(
        Id: 1002,
        Title: "Current Time",
        Icon: "far fa-clock",
        Widget: "clock",
        SectionId: 1,
        Options: MakeOptions(new { })
    );

    private ItemVm _rssItem = new(
        Id: 1003,
        Title: ".NET Blog",
        Icon: "fas fa-rss",
        Widget: "rss feed",
        SectionId: 1,
        Options: MakeOptions(new { FeedUrl = "https://devblogs.microsoft.com/dotnet/feed/", MaxItems = 3, RefreshInterval = 0 })
    );
}
